gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[i,j] <- 1
}
}
if (is.na(matrix[i,j]) == TRUE) {
matrix[i,j] == 0
}
}
}
matrix <- matrix(nrow = 19670, ncol = 400)
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[i,j] <- 1
}
}
if (is.na(matrix[i,j]) == TRUE) {
matrix[i,j] <- 0
}
}
}
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
print(str_c("Check dat: ", check_dat))
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[i,j] <- 1
}
}
if (is.na(matrix[i,j]) == TRUE) {
matrix[i,j] <- 0
}
}
}
View(case_vec)
matrix <- matrix(nrow = 19671, ncol = 401)
matrix[1,] <- case_vec$case
matrix[1,]
case_vec$case
x <- 1
for (i in case_vec$case) {
x <- x+1
matrix[x,] <- case_vec$case
}
x <- 1
for (i in case_vec$case) {
x <- x+1
matrix[x,] <- i
}
x <- 1
for (i in case_vec$case) {
x <- x+1
matrix[,x] <- i
}
matrix <- matrix(nrow = 19671, ncol = 401)
x <- 1
for (i in case_vec$case) {
x <- x+1
matrix[,x] <- i
}
View(matrix)
matrix <- matrix(nrow = 19671, ncol = 401)
x <- 0
for (i in case_vec$case) {
x <- x+1
matrix[1,x] <- i
}
colnames(matrix) <- matrix[1,]
colnames(matrix) <- matrix[1,]
View(matrix)
matrix <- matrix(nrow = 19670, ncol = 400)
colnames(matrix) <- case_vec$case
rownames(matrix) <- genes_vec$gene
matrix
View(matrix)
vec1 <- 1:100
vec2 <- 1:100
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[i,j] <- 1
}
}
if (is.na(matrix[i,j]) == TRUE) {
matrix[i,j] <- 0
}
}
}
data <- dat02 %>% filter(gene == "TRPM3")
View(data)
vec1 <- 1:10
vec2 <- 1:10
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
print(str_c("k: ", k, " gene: ", gene, " i: ", i, " j: ", j))
matrix[i,j] <- 1
}
}
if (is.na(matrix[i,j]) == TRUE) {
matrix[i,j] <- 0
}
}
}
vec1 <- 1:100
vec2 <- 1:100
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[i,j]) == TRUE) {
matrix[j,i] <- 0
}
}
}
matrix <- matrix(nrow = 19670, ncol = 400)
colnames(matrix) <- case_vec$case
rownames(matrix) <- genes_vec$gene
View(matrix)
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[i,j]) == TRUE) {
matrix[j,i] <- 0
}
}
}
matrix <- matrix(nrow = 19670, ncol = 400)
colnames(matrix) <- case_vec$case
rownames(matrix) <- genes_vec$gene
vec1 <- 1:100
vec2 <- 1:100
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
# data <- dat02 %>% filter(gene == "TRPM3")
# genes_vec$gene[1]
matrix <- matrix(nrow = 19670, ncol = 400)
colnames(matrix) <- case_vec$case
rownames(matrix) <- genes_vec$gene
vec1 <- 1:400
vec2 <- 1:10
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
# data <- dat02 %>% filter(gene == "TRPM3")
# genes_vec$gene[1]
matrix <- matrix(nrow = 19670, ncol = 400)
colnames(matrix) <- case_vec$case
rownames(matrix) <- genes_vec$gene
vec1 <- 1:400
vec2 <- 1:10
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[i,j] <- 1
}
}
if (is.na(matrix[i,j]) == TRUE) {
matrix[i,j] <- 0
}
}
}
# data <- dat02 %>% filter(gene == "TRPM3")
# genes_vec$gene[1]
vec1 <- 1:19670
vec2 <- 1:5
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[i,j] <- 1
}
}
if (is.na(matrix[i,j]) == TRUE) {
matrix[i,j] <- 0
}
}
}
matrix <- matrix(nrow = 19670, ncol = 400)
colnames(matrix) <- case_vec$case
rownames(matrix) <- genes_vec$gene
vec1 <- 1:400
vec2 <- 1:5
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
matrix <- matrix(nrow = 400, ncol = 19670)
colnames(matrix) <- genes_vec$gene
rownames(matrix) <- case_vec$case
vec1 <- 1:400
vec2 <- 1:5
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
matrix <- matrix(nrow = 19670, ncol = 400)
colnames(matrix) <- case_vec$case
rownames(matrix) <- genes_vec$gene
vec1 <- 1:400
vec2 <- 1:5
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
View(dat02)
vec1 <- 1:400
vec2 <- 6:50
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
vec2 <- 51:500
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
vec2 <- 501:1500
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
vec2 <- 1501:3000
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
vec2 <- 3001:4500
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
vec2 <- 4501:9000
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
dat02 %>% filter(case == "lung_1")
data <- dat02 %>% filter(case == "lung_1")
vec2 <- 9001:14000
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
vec2 <- 14001:19670
for (i in vec1) {
check_dat <- dat02 %>% filter(case == case_vec$case[i])
for (j in vec2) {
gene <- genes_vec$gene[j]
for (k in check_dat$gene) {
if (k == gene) {
matrix[j,i] <- 1
}
}
if (is.na(matrix[j,i]) == TRUE) {
matrix[j,i] <- 0
}
}
}
write_csv("mutation_profiles.csv")
write_csv(matrix, "mutation_profiles.csv")
matrix_df <- as.data.frame(matrix)
write_csv(matrix, "mutation_profiles.csv")
write_csv(matrix_df, "mutation_profiles.csv")
matrix_df
View(matrix_df)
write_csv(genes_vec, "genes_vec.csv")
profile_dat <- read_csv("mutation_profiles.csv")
View(profile_dat)
prof <- t(profile_dat)
View(prof)
prof <- as_tibble(prof)
View(prof)
colnames(prof) <- prof[1,]
View(prof)
prof <- prof[-1,]
View(prof)
prof <- prof %>% mutate(row = row_number())
prof <- prof %>% mutate(row = row_number())
prof <- as_tibble(prof)
prof <- prof %>% mutate(row = row_number())
prof <- prof %>% mutate(rownum = row_number())
prof <- prof %>% mutate(x = 100)
write_csv(prof, "mutation_profiles.csv")
write_csv(prof[,1:500], "mutation_1_500.csv")
write_csv(prof[,501:1000], "mutation_501_1000.csv")
View(dat)
View(case_vec)
write_csv(prof[,1:1000], "mutation_1_1000.csv")
write_csv(prof[,1001:2000], "mutation_1001_2000.csv")
write_csv(prof[,2001:3000], "mutation_1001_2000.csv")
write_csv(prof[,1001:2000], "mutation_1001_2000.csv")
write_csv(prof[,2001:3000], "mutation_2001_3000.csv")
write_csv(prof[,3001:4000], "mutation_3001_4000.csv")
write_csv(prof[,4001:5000], "mutation_4001_5000.csv")
write_csv(prof[,5001:6000], "mutation_5001_6000.csv")
write_csv(prof[,6001:7000], "mutation_6001_7000.csv")
write_csv(prof[,7001:8000], "mutation_7001_8000.csv")
write_csv(prof[,8001:9000], "mutation_8001_9000.csv")
write_csv(prof[,9001:10000], "mutation_9001_10000.csv")
write_csv(prof[,10001:11000], "mutation_10001_11000.csv")
write_csv(prof[,11001:12000], "mutation_11001_12000.csv")
write_csv(prof[,12001:13000], "mutation_12001_13000.csv")
write_csv(prof[,13001:14000], "mutation_13001_14000.csv")
write_csv(prof[,14001:15000], "mutation_14001_15000.csv")
write_csv(prof[,15001:16000], "mutation_15001_16000.csv")
write_csv(prof[,16001:17000], "mutation_16001_17000.csv")
write_csv(prof[,17001:18000], "mutation_17001_18000.csv")
write_csv(prof[,18001:19000], "mutation_18001_19000.csv")
write_csv(prof[,19001:19670], "mutation_19001_19670.csv")
View(dat)
table01 <- dat %>% count(cancer_type) %>% kable(col.names = c("primary_site", "num_cases"), align = "r")
table01
table01 <- dat %>% count(cancer_type) %>% kable(col.names = c("primary_site", "num_mutations"), align = "r")
table01
plot01 <- dat %>% ggplot(aes(x = cancer_type)) + geom_bar(aes(color = cancer_type))
plot01
table02 <- dat %>% select(-genomic_dna_change) %>% unique() %>% group_by(cancer_type) %>% count(gene) %>% arrange(desc(n)) %>% filter(n >= 25)
table02
table02 <- dat %>% select(-genomic_dna_change) %>% unique() %>% group_by(cancer_type) %>% count(gene) %>% arrange(desc(n)) %>% filter(n > 50) %>% kable()
table02
View(table02)
View(table02)
table02 <- dat %>% select(-genomic_dna_change) %>% unique() %>% group_by(cancer_type) %>% count(gene) %>% arrange(desc(n)) %>% filter(n > 50)
table02
table02 <- dat %>% select(-genomic_dna_change) %>% unique() %>% group_by(cancer_type) %>% count(gene) %>% arrange(desc(n)) %>% filter(n > 70) %>% kable()
table02
table02 %>% ggplot(aes(x = gene, y = n, color = cancer_type)) + geom_col()
table02 <- dat %>% select(-genomic_dna_change) %>% unique() %>% group_by(cancer_type) %>% count(gene) %>% arrange(desc(n)) %>% filter(n > 70)
table02 %>% ggplot(aes(x = gene, y = n, color = cancer_type)) + geom_col()
table02 <- dat %>% select(-genomic_dna_change) %>% unique() %>% group_by(cancer_type) %>% count(gene) %>% arrange(desc(n)) %>% filter(n > 30)
table02 %>% ggplot(aes(x = gene, y = n, color = cancer_type)) + geom_col()
View(table02)
table02 %>% ggplot(aes(x = cancer_type, y = gene)) + geom_tile(aes(fill = n)) +
scale_fill_gradient(low = "white", high = "blue")
table02 <- dat %>% select(-genomic_dna_change) %>% unique() %>% group_by(cancer_type) %>% count(gene) %>% arrange(desc(n)) %>% filter(n > 50)
table02 %>% ggplot(aes(x = cancer_type, y = gene)) + geom_tile(aes(fill = n)) +
scale_fill_gradient(low = "white", high = "blue")
dat02 <- dat %>% select(-genomic_dna_change) %>% unique()
dat02 %>% count(cancer_type)
dat02 <- dat02 %>% mutate(occurrances = ifelse(cancer_type == "brain", 66596,
ifelse(cancer_type == "kidney", 17457,
ifelse(cancer_type == "leukemia", 10320,
ifelse(cancer_type == "lung", 114409, NA)))))
dat03 <- dat02 %>% group_by(cancer_type, occurrances) %>% count(gene) %>% mutate(proportion = (n/occurrances)*100)
dat03 <- dat03 %>% ungroup(cancer_type, occurances) %>% select(cancer_type, gene, proportion) %>% arrange(desc(proportion))
dat02 %>% count(cancer_type) %>% kable()
dat02 <- dat02 %>% mutate(occurrances = ifelse(cancer_type == "brain", 66596,
ifelse(cancer_type == "kidney", 17457,
ifelse(cancer_type == "leukemia", 10320,
ifelse(cancer_type == "lung", 114409, NA)))))
dat03 <- dat02 %>% group_by(cancer_type, occurrances) %>% count(gene) %>% mutate(proportion = (n/occurrances)*100)
dat03
dat03 <- dat03 %>% ungroup(cancer_type, occurances) %>% select(cancer_type, gene, proportion) %>% arrange(desc(proportion))
dat03
dat03 %>% kable()
dat03 %>% ggplot(aes(x = cancer_type, y = gene)) + geom_tile(aes(fill = proportion)) +
scale_fill_gradient(low = "blue", high = "red")
dat03 %>% filter(proportion >= .05) %>% ggplot(aes(x = cancer_type, y = gene)) + geom_tile(aes(fill = proportion)) + scale_fill_gradient(low = "blue", high = "red")
dat03 %>% filter(proportion >= .10) %>% ggplot(aes(x = cancer_type, y = gene)) + geom_tile(aes(fill = proportion)) + scale_fill_gradient(low = "blue", high = "red")
